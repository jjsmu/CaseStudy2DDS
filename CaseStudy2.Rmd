---
title: "CaseStudy2"
author: "jjsmu"
date: "2023-12-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r, echo=FALSE}

# Print Session Information 
sessionInfo()

# Install Packages
install.packages("ggplot2")
install.packages("tidyverse")
install.packages("naniar")
install.packages("GGally")
install.packages("plotly")
install.packages("e1071")
install.packages("aws.s3")

# Load Libraries
library(aws.s3)
library(e1071)
library(ggplot2)
library(GGally)
library(plotly)
#library(magrittr)
library(tidyverse)
library(naniar)
```

## Import the Case Study 2 df_casestudy2set

```{r, echo=FALSE}

# Source Exploratory df_casestudy2 Analysis R script to relative path
#source("analysis/eda.R", echo=FALSE)

# Get the current working directory
getwd()

# Set the current directory to the df_casestudy2 folder
#setwd("df_casestudy2")

# List files in root dir
list.files()

# Fetch df_casestudy2set from local df_casestudy2 folder
#df_cs2 = read.csv("df_casestudy2/CaseStudy2-df_casestudy2.csv", header = TRUE) # TODO change to relative path file
#df_cs2_no_attrition = read.csv("df_casestudy2/CaseStudy2CompSet No Attrition.csv", header = TRUE) # TODO change to relative path file
#df_cs2_no_salary = read.csv("df_casestudy2/CaseStudy2CompSet No Salary.csv", header = TRUE) # TODO change to relative path file

# Fetch datasets from AWS S3 repository
Sys.setenv("AWS_ACCESS_KEY_ID" = "",
           "AWS_SECRET_ACCESS_KEY" = "",
           "AWS_DEFAULT_REGION" = "us-west-2")
aws.s3::bucketlist()
aws.s3::get_bucket("casestudy2")
df_casestudy2 = s3read_using(FUN = read.csv, bucket = "casestudy2", object = "CaseStudy2-data.csv")
df_cs2_no_attrition = s3read_using(FUN = read.csv, bucket = "casestudy2", object = "CaseStudy2CompSet No Attrition.csv")
df_cs2_no_salary = s3read_using(FUN = read.csv, bucket = "casestudy2", object = "CaseStudy2CompSet No Salary.csv")

```
## Tidy the Case Study 2 df_casestudy2set

```{r}
# Let's take a look at what we are working with first
View(df_casestudy2)
View(df_cs2_no_attrition)
View(df_cs2_no_salary)


# Next we want to see what's in the meta df_casestudy2set 
str(df_casestudy2)
str(df_cs2_no_attrition)
str(df_cs2_no_salary)

# Print summary of the df_casestudy2set
summary(df_casestudy2)
summary(df_cs2_no_attrition)
summary(df_cs2_no_salary)

# Print the first 5 rows 
head(df_casestudy2, n = 5)
head(df_cs2_no_attrition, n = 5)
head(df_cs2_no_salary, n = 5)
# Print the last 5 rows
tail(df_casestudy2, n = 5)
tail(df_cs2_no_attrition, n = 5)
tail(df_cs2_no_salary, n = 5)

# Print the number of rows and columns
dim(df_casestudy2)
dim(df_cs2_no_attrition)
dim(df_cs2_no_salary)

# Variables # missing
gg_miss_var(df_casestudy2)
gg_miss_var(df_cs2_no_attrition)
gg_miss_var(df_cs2_no_salary)

```

## Transform the Case Study 2 df_casestudy2set
```{r}
# Dataframe employee basic information
df_emp <- df_casestudy2 %>% 
  select(ID, Age, Gender, Education, EducationField, DistanceFromHome, MaritalStatus, NumCompaniesWorked, TotalWorkingYears, YearsAtCompany, YearsInCurrentRole, YearsWithCurrManager, YearsSinceLastPromotion)
# Dataframe employee company information
df_jobs <- df_casestudy2 %>%
  select(ID, JobInvolvement, JobLevel, JobRole, JobSatisfaction)
# Dataframe employee pay information
df_pay <- df_casestudy2 %>%
  select(ID, DailyRate, HourlyRate, MonthlyRate, MonthlyIncome, OverTime)
```

## Visualize the Case Study 2 df_casestudy2set
```{r}
# Distribution of Job Roles
df_jobs %>% ggplot(aes(JobRole)) + geom_bar() 


```


### EDA: scatterplots, histograms, boxplots, barplot
### 3D plots with plotly

## Model the Case Study 2 df_casestudy2set

### Classification
```{r, echo = FALSE}
# Linear Regression
# Naive Bayes
# KNN & LOOCV
```

## Present the Case Study 2 df_casestudy2set